<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Área Médica — Geriatria 360</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    // Modelos de atestado
const certModels = {
  modelo1: `ATESTADO MÉDICO

Atesto, para os devidos fins, que o(a) paciente {{nome}} foi atendido(a) nesta data, apresentando condição clínica que justifica afastamento das atividades habituais por {{dias}} dias, a contar de hoje.

{{cid}}
Recomendado repouso e acompanhamento clínico.
Retorno conforme evolução.`,

  modelo2: `ATESTADO DE APTIDÃO FÍSICA

Atesto, para os devidos fins, que o(a) paciente {{nome}} foi avaliado(a) em consulta médica, não apresentando contraindicações aparentes à prática de atividades físicas de forma orientada.

Recomenda-se acompanhamento periódico e observar sinais e sintomas durante o exercício.`,

  modelo3: `ATESTADO DE COMPARECIMENTO

Atesto que o(a) paciente {{nome}} esteve em atendimento médico nesta unidade no dia {{data}} das {{horaInicio}} às {{horaFim}}.

Recomenda-se abono de falta conforme legislação vigente.`,

  modelo4: `ATESTADO PARA ACOMPANHANTE

Atesto, para os devidos fins, que {{acompanhante}} acompanhou o(a) paciente {{nome}} em atendimento médico nesta data, sendo necessária sua presença durante o período.

Sugiro o abono da ausência conforme normas institucionais.`
};

// CID-10 para atestado
let selectedCidsAtestado = [];

function changeCertModel(model) {
  const certReason = document.getElementById('certReason');
  const certFields = document.getElementById('certFields');
  
  certFields.innerHTML = '';
  selectedCidsAtestado = [];
  updateCIDChipsAtestado();
  
  if (model && certModels[model]) {
    certReason.value = certModels[model];
    
    switch(model) {
      case 'modelo1':
        certFields.innerHTML = `
          <div class="cert-field-group">
            <div class="form-group">
              <label for="certNome">Nome do Paciente</label>
              <input type="text" id="certNome" class="form-control" placeholder="Nome completo ou iniciais">
            </div>
            <div class="form-group">
              <label for="certDias">Dias de Afastamento</label>
              <input type="number" id="certDias" class="form-control" min="1" value="3">
            </div>
          </div>
        `;
        break;
        
      case 'modelo2':
        certFields.innerHTML = `
          <div class="form-group">
            <label for="certNome">Nome do Paciente</label>
            <input type="text" id="certNome" class="form-control" placeholder="Nome completo ou iniciais">
          </div>
        `;
        break;
        
      case 'modelo3':
        const today = new Date().toISOString().split('T')[0];
        certFields.innerHTML = `
          <div class="cert-field-group">
            <div class="form-group">
              <label for="certNome">Nome do Paciente</label>
              <input type="text" id="certNome" class="form-control" placeholder="Nome completo ou iniciais">
            </div>
            <div class="form-group">
              <label for="certData">Data do Atendimento</label>
              <input type="date" id="certData" class="form-control" value="${today}">
            </div>
          </div>
          <div class="cert-field-group">
            <div class="form-group">
              <label for="certHoraInicio">Hora Início</label>
              <input type="time" id="certHoraInicio" class="form-control" value="09:00">
            </div>
            <div class="form-group">
              <label for="certHoraFim">Hora Fim</label>
              <input type="time" id="certHoraFim" class="form-control" value="10:00">
            </div>
          </div>
        `;
        break;
        
      case 'modelo4':
        certFields.innerHTML = `
          <div class="cert-field-group">
            <div class="form-group">
              <label for="certNome">Nome do Paciente</label>
              <input type="text" id="certNome" class="form-control" placeholder="Nome do paciente">
            </div>
            <div class="form-group">
              <label for="certAcompanhante">Nome do Acompanhante</label>
              <input type="text" id="certAcompanhante" class="form-control" placeholder="Nome do acompanhante">
            </div>
          </div>
        `;
        break;
    }
    
    initCIDSearchAtestado();
  }
}

function initCIDSearchAtestado() {
  const cidSearch = document.getElementById('cidSearchAtestado');
  const cidResults = document.getElementById('cidResultsAtestado');
  
  if (!cidSearch) return;
  
  cidSearch.addEventListener('input', function() {
    const query = this.value.toLowerCase();
    
    if (query.length < 2) {
      cidResults.style.display = 'none';
      return;
    }
    
    const filtered = cidData.filter(item => 
      item.code.toLowerCase().includes(query) || 
      item.description.toLowerCase().includes(query)
    );
    
    displayCIDResultsAtestado(filtered);
  });
  
  document.addEventListener('click', function(e) {
    if (!cidSearch.contains(e.target) && !cidResults.contains(e.target)) {
      cidResults.style.display = 'none';
    }
  });
}

function displayCIDResultsAtestado(results) {
  const cidResults = document.getElementById('cidResultsAtestado');
  cidResults.innerHTML = '';
  
  if (results.length === 0) {
    cidResults.innerHTML = '<div class="cid-result">Nenhum CID encontrado</div>';
  } else {
    results.slice(0, 10).forEach(item => {
      const div = document.createElement('div');
      div.className = 'cid-result';
      div.innerHTML = `<strong>${item.code}</strong> - ${item.description}`;
      div.addEventListener('click', () => selectCIDAtestado(item));
      cidResults.appendChild(div);
    });
  }
  
  cidResults.style.display = 'block';
}

function selectCIDAtestado(cid) {
  if (!selectedCidsAtestado.find(item => item.code === cid.code)) {
    selectedCidsAtestado.push(cid);
    updateCIDChipsAtestado();
    updateCertTextWithCID();
  }
  
  document.getElementById('cidSearchAtestado').value = '';
  document.getElementById('cidResultsAtestado').style.display = 'none';
}

function updateCIDChipsAtestado() {
  const container = document.getElementById('cidChipsAtestado');
  container.innerHTML = '';
  
  selectedCidsAtestado.forEach(cid => {
    const chip = document.createElement('div');
    chip.className = 'cid-chip';
    chip.innerHTML = `
      ${cid.code} - ${cid.description}
      <button onclick="removeCIDAtestado('${cid.code}')"><i class="fas fa-times"></i></button>
    `;
    container.appendChild(chip);
  });
}

function removeCIDAtestado(code) {
  selectedCidsAtestado = selectedCidsAtestado.filter(item => item.code !== code);
  updateCIDChipsAtestado();
  updateCertTextWithCID();
}

function updateCertTextWithCID() {
  const certReason = document.getElementById('certReason');
  let text = certReason.value;
  
  text = text.replace(/\nCID: .+$/, '');
  
  if (selectedCidsAtestado.length > 0) {
    const cids = selectedCidsAtestado.map(cid => `${cid.code} - ${cid.description}`).join(', ');
    text += `\nCID: ${cids}`;
  }
  
  certReason.value = text;
}

function generateCertText() {
  const model = document.getElementById('certModel').value;
  let text = document.getElementById('certReason').value;
  
  if (!model) {
    alert('Selecione um modelo de atestado primeiro.');
    return null;
  }
  
  const nome = document.getElementById('certNome') ? document.getElementById('certNome').value : '';
  text = text.replace(/{{nome}}/g, nome);
  
  switch(model) {
    case 'modelo1':
      const dias = document.getElementById('certDias') ? document.getElementById('certDias').value : '';
      text = text.replace(/{{dias}}/g, dias);
      break;
      
    case 'modelo3':
      const data = document.getElementById('certData') ? document.getElementById('certData').value : '';
      const horaInicio = document.getElementById('certHoraInicio') ? document.getElementById('certHoraInicio').value : '';
      const horaFim = document.getElementById('certHoraFim') ? document.getElementById('certHoraFim').value : '';
      
      const dataFormatada = data ? new Date(data).toLocaleDateString('pt-BR') : '';
      
      text = text.replace(/{{data}}/g, dataFormatada);
      text = text.replace(/{{horaInicio}}/g, horaInicio);
      text = text.replace(/{{horaFim}}/g, horaFim);
      break;
      
    case 'modelo4':
      const acompanhante = document.getElementById('certAcompanhante') ? document.getElementById('certAcompanhante').value : '';
      text = text.replace(/{{acompanhante}}/g, acompanhante);
      break;
  }
  
  return text;
}

function saveCertificate() {
  const certText = generateCertText();
  if (certText) {
    localStorage.setItem('lastCertificate', certText);
    alert('Atestado salvo com sucesso!');
  }
}

function printCertificate() {
  const certText = generateCertText();
  if (!certText) return;
  
  const printContent = `
    <div style="padding: 30px; font-family: Arial; line-height: 1.6;">
      <div style="white-space: pre-wrap; font-size: 14px;">${certText}</div>
      <br><br><br>
      <div style="margin-top: 50px; text-align: center;">
        <p>_________________________________________</p>
        <p><strong>Dr. Silva</strong></p>
        <p>CRM: 123456</p>
        <p>Geriatria 360</p>
      </div>
    </div>
  `;
  
  const printWindow = window.open('', '_blank');
  printWindow.document.write(printContent);
  printWindow.document.close();
  printWindow.print();
}

// Base de dados de CID-10 (adicione esta variável se não existir)
const cidData = [
  { code: "A00", description: "Cólera" },
  { code: "A01", description: "Febres tifóide e paratifóide" },
  { code: "I10", description: "Hipertensão essencial (primária)" },
  { code: "I11", description: "Doença cardíaca hipertensiva" },
  { code: "E10", description: "Diabetes mellitus insulinodependente" },
  { code: "E11", description: "Diabetes mellitus não-insulinodependente" },
  { code: "F00", description: "Demência na doença de Alzheimer" },
  { code: "F03", description: "Demência não especificada" },
  { code: "G20", description: "Doença de Parkinson" },
  { code: "J45", description: "Asma" },
  { code: "M19", description: "Outras artroses" },
  { code: "N18", description: "Doença renal crônica" },
  { code: "R05", description: "Tosse" },
  { code: "R53", description: "Mal-estar e fadiga" },
  { code: "Z00", description: "Exame geral de rotina" }
];
   /* Estilos para atestados */
.cert-field-group {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 15px;
  margin-bottom: 15px;
}

.cert-field-full {
  grid-column: 1 / -1;
}

.cid-search-container {
  position: relative;
}

.cid-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 1px solid var(--gray-light);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  max-height: 200px;
  overflow-y: auto;
  z-index: 10;
  display: none;
}

.cid-result {
  padding: 10px 15px;
  cursor: pointer;
  border-bottom: 1px solid var(--gray-light);
}

.cid-result:hover {
  background: var(--gray-light);
}

.cid-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 10px;
}

.cid-chip {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--primary-light);
  color: white;
  padding: 5px 12px;
  border-radius: 20px;
  font-size: 0.9rem;
}

.cid-chip button {
  background: none;
  border: none;
  color: white;
  cursor: pointer;
  font-size: 0.8rem;
} 
    :root {
      --primary: #2c5aa0;
      --primary-light: #4a7bc8;
      --secondary: #34a38a;
      --accent: #ff7b54;
      --danger: #e74c3c;
      --warning: #f39c12;
      --success: #27ae60;
      --light: #f8f9fa;
      --dark: #343a40;
      --gray: #6c757d;
      --gray-light: #e9ecef;
      --border-radius: 10px;
      --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--dark);
      background-color: #f5f7fa;
    }
    
    .container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .medical-header {
      background: white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
    }
    
    .medical-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: var(--primary);
      font-weight: 700;
      font-size: 1.5rem;
    }
    
    .medical-nav {
      display: flex;
      gap: 20px;
      align-items: center;
    }
    
    .medical-nav a {
      text-decoration: none;
      color: var(--dark);
      font-weight: 500;
      transition: var(--transition);
    }
    
    .medical-user {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--gray);
    }
    
    .medical-user img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }
    
    .login-container {
      max-width: 500px;
      margin: 80px auto;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 40px;
    }
    
    .login-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    
    .form-control {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--gray-light);
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
    }
    
    .btn {
      display: inline-block;
      padding: 12px 25px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
    }
    
    .btn:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
    }
    
    .btn-block {
      display: block;
      width: 100%;
    }
    
    .btn-success {
      background: var(--success);
    }
    
    .btn-success:hover {
      background: #219653;
    }
    
    .medical-main {
      display: none;
      padding: 30px 0;
    }
    
    .medical-dashboard {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 30px;
    }
    
    .medical-sidebar {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 25px;
      height: fit-content;
      position: sticky;
      top: 90px;
    }
    
    .patient-info {
      text-align: center;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--gray-light);
      margin-bottom: 20px;
    }
    
    .patient-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 15px;
      border: 3px solid var(--primary-light);
    }
    
    .medical-tabs {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .medical-tab {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 15px;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      color: var(--dark);
    }
    
    .medical-tab.active {
      background: var(--primary);
      color: white;
    }
    
    .medical-content {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 30px;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .tab-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--gray-light);
    }
    
    .cid-search-container {
      position: relative;
      margin-bottom: 20px;
    }
    
    .cid-results {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid var(--gray-light);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      max-height: 200px;
      overflow-y: auto;
      z-index: 10;
      display: none;
    }
    
    .cid-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .cid-chip {
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--primary-light);
      color: white;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
    }
    
    .editor-toolbar {
      display: flex;
      gap: 5px;
      padding: 10px;
      background: var(--gray-light);
      border-radius: var(--border-radius) var(--border-radius) 0 0;
    }
    
    .medical-editor {
      width: 100%;
      min-height: 300px;
      padding: 15px;
      border: 1px solid var(--gray-light);
      border-top: none;
      border-radius: 0 0 var(--border-radius) var(--border-radius);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 1rem;
      resize: vertical;
    }
    
    .medication-form {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .medication-list {
      border: 1px solid var(--gray-light);
      border-radius: var(--border-radius);
      overflow: hidden;
    }
    
    .medication-item {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 15px;
      padding: 15px;
      border-bottom: 1px solid var(--gray-light);
      align-items: center;
    }
    
    .medication-item:last-child {
      border-bottom: none;
    }
    
    /* CORREÇÃO DO CALENDÁRIO */
    .calendar-container {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      overflow: hidden;
      margin-bottom: 30px;
    }
    
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: var(--primary);
      color: white;
    }
    
    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
    }
    
    .calendar-day {
      padding: 10px;
      text-align: center;
      font-weight: 600;
      background: var(--gray-light);
    }
    
    .calendar-dates {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-auto-rows: 60px;
    }
    
    .calendar-date {
      padding: 10px;
      text-align: center;
      border: 1px solid var(--gray-light);
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .calendar-date.today {
      background: var(--primary-light);
      color: white;
    }
    
    .appointment-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px;
      border: 1px solid var(--gray-light);
      border-radius: var(--border-radius);
      margin-bottom: 15px;
    }
    
    .documents-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .document-card {
      background: var(--light);
      border-radius: var(--border-radius);
      padding: 20px;
      transition: var(--transition);
    }
    
    .document-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--box-shadow);
    }
    
    .document-icon {
      width: 60px;
      height: 60px;
      background: var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      margin-bottom: 15px;
    }
    
    .exam-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .exam-category {
      background: var(--light);
      padding: 15px;
      border-radius: var(--border-radius);
    }
    
    .exam-category h4 {
      margin-bottom: 10px;
      color: var(--primary);
    }
    
    .exam-list {
      max-height: 200px;
      overflow-y: auto;
    }
    
    .exam-item {
      padding: 8px 0;
      border-bottom: 1px solid var(--gray-light);
      cursor: pointer;
      transition: var(--transition);
    }
    
    .exam-item:hover {
      background: white;
      padding-left: 5px;
    }
    
    .alert {
      padding: 15px;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
    }
    
    .alert-error {
      background: #fde8e6;
      color: var(--danger);
      border: 1px solid #f5b4ab;
    }
    
    @media (max-width: 1200px) {
      .medical-dashboard {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .medication-form {
        grid-template-columns: 1fr;
      }
      
      .medication-item {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      
      .documents-grid {
        grid-template-columns: 1fr;
      }
      
      .exam-options {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="medical-header">
    <div class="container">
      <div class="header-content">
        <a href="index.html" class="medical-brand">
          <i class="fas fa-heartbeat"></i>
          <span>Geriatria 360</span>
        </a>
        
        <nav class="medical-nav">
          <a href="index.html"><i class="fas fa-home"></i> Início</a>
          <a href="#"><i class="fas fa-calendar-alt"></i> Agenda</a>
        </nav>
        
        <div class="medical-user">
          <img src="https://ui-avatars.com/api/?name=Dr+Silva&background=2c5aa0&color=fff" alt="Dr. Silva">
          <div>Dr. Silva</div>
        </div>
      </div>
    </div>
  </header>

  <section id="loginArea" class="login-container">
    <div class="login-header">
      <h1>Área Médica</h1>
      <p>Acesso restrito a profissionais de saúde</p>
    </div>
    
    <form id="loginForm">
      <div class="form-group">
        <label for="med-user">CRM</label>
        <input type="text" id="med-user" class="form-control" placeholder="Digite seu CRM">
      </div>
      
      <div class="form-group">
        <label for="med-pass">Senha</label>
        <input type="password" id="med-pass" class="form-control" placeholder="Digite sua senha">
      </div>
      
      <button type="button" class="btn btn-block" onclick="loginMed()">Entrar na Área Médica</button>
    </form>
    
    <div class="alert alert-error" id="loginError" style="display: none;">
      CRM ou senha incorretos. Tente novamente.
    </div>
  </section>

  <section id="medicalArea" class="medical-main">
    <div class="container">
      <div class="medical-dashboard">
        <aside class="medical-sidebar">
          <div class="patient-info">
            <img src="https://ui-avatars.com/api/?name=Maria+Silva&background=34a38a&color=fff" alt="Maria Silva" class="patient-avatar">
            <h3>Maria Silva</h3>
            <p>ID: <strong>MS-75-001</strong></p>
          </div>
          
          <div class="medical-tabs">
            <a href="#" class="medical-tab active" data-tab="evolucao">
              <i class="fas fa-stethoscope"></i>
              <span>Evolução Médica</span>
            </a>
            <a href="#" class="medical-tab" data-tab="medicacao">
              <i class="fas fa-pills"></i>
              <span>Medicação</span>
            </a>
            <a href="#" class="medical-tab" data-tab="atestados">
              <i class="fas fa-file-medical"></i>
              <span>Atestados</span>
            </a>
            <a href="#" class="medical-tab" data-tab="documentos">
              <i class="fas fa-file-contract"></i>
              <span>Documentos</span>
            </a>
            <a href="#" class="medical-tab" data-tab="agendamento">
              <i class="fas fa-calendar-check"></i>
              <span>Agendamento</span>
            </a>
            <a href="#" class="medical-tab" data-tab="exames">
              <i class="fas fa-vial"></i>
              <span>Solicitar Exames</span>
            </a>
          </div>
        </aside>
        
        <main class="medical-content">
          <!-- Evolução Médica -->
          <div id="evolucao" class="tab-content active">
            <div class="tab-header">
              <h2>Evolução Médica</h2>
              <div class="tab-actions">
                <button class="btn" onclick="saveEvolution()"><i class="fas fa-save"></i> Salvar</button>
                <button class="btn btn-success" onclick="generateAIReport()"><i class="fas fa-robot"></i> Gerar Laudo IA</button>
              </div>
            </div>
            
            <div class="cid-search-container">
              <input type="text" id="cidSearch" class="form-control" placeholder="Digite código CID-10 (ex: I10) ou descrição...">
              <div id="cidResults" class="cid-results"></div>
            </div>
            
            <div id="cidChips" class="cid-chips"></div>
            
            <div class="editor-container">
              <div class="editor-toolbar">
                <button type="button" title="Negrito" onclick="formatText('bold')"><i class="fas fa-bold"></i></button>
                <button type="button" title="Itálico" onclick="formatText('italic')"><i class="fas fa-italic"></i></button>
                <button type="button" title="Sublinhado" onclick="formatText('underline')"><i class="fas fa-underline"></i></button>
              </div>
              <div id="evolText" class="medical-editor" contenteditable="true">
                <p><strong>Queixa Principal:</strong> Paciente relata dor articular difusa há aproximadamente 3 meses, com piora progressiva.</p>
              </div>
            </div>
          </div>
          
          <!-- Medicação -->
          <div id="medicacao" class="tab-content">
            <div class="tab-header">
              <h2>Prescrição de Medicação</h2>
              <div class="tab-actions">
                <button class="btn" onclick="savePrescription()"><i class="fas fa-save"></i> Salvar Receita</button>
                <button class="btn" onclick="printPrescription()"><i class="fas fa-print"></i> Imprimir</button>
              </div>
            </div>
            
            <div class="medication-container">
              <div class="medication-form">
                <input type="text" id="medName" class="form-control" placeholder="Medicamento" list="medSuggestions">
                <datalist id="medSuggestions">
                  <option value="Losartana 50mg">
                  <option value="AAS 100mg">
                  <option value="Sinvastatina 20mg">
                  <option value="Metformina 850mg">
                </datalist>
                <input type="text" id="medDosage" class="form-control" placeholder="Posologia (ex: 1x ao dia)">
                <input type="text" id="medDuration" class="form-control" placeholder="Duração (ex: 30 dias)">
                <button type="button" class="btn" onclick="addMedication()"><i class="fas fa-plus"></i> Adicionar</button>
              </div>
              
              <div class="medication-list" id="medicationListContainer">
                <!-- Medicamentos aparecerão aqui -->
              </div>
            </div>
          </div>
          
<!-- Atestados -->
<div id="atestados" class="tab-content">
  <div class="tab-header">
    <h2>Emitir Atestados</h2>
    <div class="tab-actions">
      <button class="btn" onclick="saveCertificate()"><i class="fas fa-save"></i> Salvar</button>
      <button class="btn" onclick="printCertificate()"><i class="fas fa-print"></i> Imprimir</button>
    </div>
  </div>
  
  <div class="form-group">
    <label for="certModel">Modelo de Atestado</label>
    <select id="certModel" class="form-control" onchange="changeCertModel(this.value)">
      <option value="">Selecione um modelo</option>
      <option value="modelo1">Modelo 1 - Afastamento</option>
      <option value="modelo2">Modelo 2 - Aptidão Física</option>
      <option value="modelo3">Modelo 3 - Comparecimento</option>
      <option value="modelo4">Modelo 4 - Acompanhante</option>
    </select>
  </div>

  <div id="certFields">
    <!-- Campos dinâmicos aparecem aqui -->
  </div>

  <div class="form-group">
    <label for="cidSearchAtestado">CID-10 (opcional)</label>
    <div class="cid-search-container">
      <input type="text" id="cidSearchAtestado" class="form-control" placeholder="Digite código CID-10 ou descrição...">
      <div id="cidResultsAtestado" class="cid-results"></div>
    </div>
    <div id="cidChipsAtestado" class="cid-chips"></div>
  </div>

  <div class="form-group">
    <label for="certReason">Texto do Atestado</label>
    <textarea id="certReason" class="form-control" rows="8" placeholder="O texto do atestado será preenchido automaticamente..."></textarea>
  </div>
</div>

            <div class="form-group">
              <label for="certRestrictions">Restrições / Recomendações</label>
              <textarea id="certRestrictions" class="form-control" rows="3" placeholder="Descreva restrições ou recomendações..."></textarea>
            </div>
          </div>
          
          <!-- Documentos -->
          <div id="documentos" class="tab-content">
            <div class="tab-header">
              <h2>Documentos Médicos</h2>
              <div class="tab-actions">
                <button class="btn" onclick="newDocument()"><i class="fas fa-plus"></i> Novo Documento</button>
              </div>
            </div>
            
            <div class="documents-grid">
              <div class="document-card">
                <div class="document-icon">
                  <i class="fas fa-file-prescription"></i>
                </div>
                <h3>Receituário</h3>
                <p>Prescrição de medicamentos controlados e simples</p>
                <button class="btn" onclick="openDocument('receita')">Abrir</button>
              </div>
              
              <div class="document-card">
                <div class="document-icon">
                  <i class="fas fa-file-medical-alt"></i>
                </div>
                <h3>Solicitação de Exames</h3>
                <p>Solicitação de exames laboratoriais e de imagem</p>
                <button class="btn" onclick="openDocument('exames')">Abrir</button>
              </div>
              
              <div class="document-card">
                <div class="document-icon">
                  <i class="fas fa-ambulance"></i>
                </div>
                <h3>Encaminhamento</h3>
                <p>Encaminhamento para especialistas ou serviços de saúde</p>
                <button class="btn" onclick="openDocument('encaminhamento')">Abrir</button>
              </div>
              
              <div class="document-card">
                <div class="document-icon">
                  <i class="fas fa-procedures"></i>
                </div>
                <h3>Relatório de Internação</h3>
                <p>Relatório médico para processos de internação</p>
                <button class="btn" onclick="openDocument('internacao')">Abrir</button>
              </div>
            </div>
          </div>
          
          <!-- Agendamento -->
          <div id="agendamento" class="tab-content">
            <div class="tab-header">
              <h2>Agendamento de Consultas</h2>
              <div class="tab-actions">
                <button class="btn" onclick="newAppointment()"><i class="fas fa-plus"></i> Nova Consulta</button>
              </div>
            </div>
            
            <div class="calendar-container">
              <div class="calendar-header">
                <div class="calendar-nav">
                  <button onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                </div>
                <h3 id="currentMonth">Junho 2023</h3>
                <div class="calendar-nav">
                  <button onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                </div>
              </div>
              
              <div class="calendar-grid">
                <div class="calendar-day">Dom</div>
                <div class="calendar-day">Seg</div>
                <div class="calendar-day">Ter</div>
                <div class="calendar-day">Qua</div>
                <div class="calendar-day">Qui</div>
                <div class="calendar-day">Sex</div>
                <div class="calendar-day">Sáb</div>
              </div>
              
              <div id="calendarDates" class="calendar-dates">
                <!-- Datas serão inseridas aqui pelo JavaScript -->
              </div>
            </div>
            
            <div class="appointment-list">
              <h3 style="margin-bottom: 20px;">Consultas Agendadas</h3>
              <div id="appointmentsContainer">
                <!-- Consultas aparecerão aqui -->
              </div>
            </div>
          </div>
          
          <!-- Solicitar Exames -->
          <div id="exames" class="tab-content">
            <div class="tab-header">
              <h2>Solicitação de Exames</h2>
              <div class="tab-actions">
                <button class="btn" onclick="saveExams()"><i class="fas fa-save"></i> Salvar</button>
                <button class="btn" onclick="printExams()"><i class="fas fa-print"></i> Imprimir</button>
              </div>
            </div>
            
            <div class="exam-options">
              <div class="exam-category">
                <h4>Exames Laboratoriais</h4>
                <div class="exam-list" id="labExams">
                  <!-- Exames laboratoriais serão inseridos aqui -->
                </div>
              </div>
              <div class="exam-category">
                <h4>Exames de Imagem</h4>
                <div class="exam-list" id="imageExams">
                  <!-- Exames de imagem serão inseridos aqui -->
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="examInput">Outros Exames (digite)</label>
              <div style="display: flex; gap: 10px;">
                <input type="text" id="examInput" class="form-control" placeholder="Ex: Hemograma completo, Glicemia...">
                <button type="button" class="btn" onclick="addCustomExam()"><i class="fas fa-plus"></i> Adicionar</button>
              </div>
            </div>
            
            <div class="form-group">
              <label>Exames Selecionados</label>
              <ul id="examList" style="background: var(--light); padding: 15px; border-radius: var(--border-radius);">
                <!-- Exames aparecerão aqui -->
              </ul>
            </div>
          </div>
        </main>
      </div>
    </div>
  </section>

  <script>
    // Arrays para armazenar dados
    let medications = [];
    let exams = [];
    let appointments = [];
    let selectedCids = [];

    // Listas de exames pré-definidos
    const labExams = [
      "Hemograma completo",
      "Glicemia em jejum",
      "Colesterol total e frações",
      "Triglicerídeos",
      "TGO/TGP",
      "Creatinina",
      "Ureia",
      "TSH e T4 livre",
      "Vitamina B12",
      "Vitamina D",
      "Ácido fólico",
      "PCR",
      "VHS",
      "Urina tipo I",
      "Urocultura"
    ];

    const imageExams = [
      "Raio-X de tórax",
      "Raio-X de coluna lombar",
      "Ultrassonografia abdominal",
      "Ultrassonografia de próstata",
      "Densitometria óssea",
      "Tomografia de crânio",
      "Ressonância de coluna",
      "Ecocardiograma",
      "Doppler de carótidas",
      "Mamografia"
    ];
    
    // Login
    function loginMed() {
      const user = document.getElementById('med-user').value;
      const pass = document.getElementById('med-pass').value;
      
      if (user === '123456' && pass === 'medico123') {
        document.getElementById('loginArea').style.display = 'none';
        document.getElementById('medicalArea').style.display = 'block';
        initCalendar();
        setupTabNavigation();
        initExams();
      } else {
        document.getElementById('loginError').style.display = 'block';
      }
    }
    
    // Navegação por abas
    function setupTabNavigation() {
      const tabs = document.querySelectorAll('.medical-tab');
      tabs.forEach(tab => {
        tab.addEventListener('click', function(e) {
          e.preventDefault();
          tabs.forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          
          this.classList.add('active');
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
        });
      });
    }

    // Inicializar exames pré-definidos
    function initExams() {
      const labExamsContainer = document.getElementById('labExams');
      const imageExamsContainer = document.getElementById('imageExams');

      labExams.forEach(exam => {
        const examItem = document.createElement('div');
        examItem.className = 'exam-item';
        examItem.textContent = exam;
        examItem.addEventListener('click', () => addPredefinedExam(exam));
        labExamsContainer.appendChild(examItem);
      });

      imageExams.forEach(exam => {
        const examItem = document.createElement('div');
        examItem.className = 'exam-item';
        examItem.textContent = exam;
        examItem.addEventListener('click', () => addPredefinedExam(exam));
        imageExamsContainer.appendChild(examItem);
      });
    }

    function addPredefinedExam(exam) {
      if (!exams.includes(exam)) {
        exams.push(exam);
        renderExams();
      }
    }
    
    // Sistema de medicamentos
    function addMedication() {
      const name = document.getElementById('medName').value;
      const dosage = document.getElementById('medDosage').value;
      const duration = document.getElementById('medDuration').value;
      
      if (name && dosage) {
        medications.push({ name, dosage, duration });
        renderMedications();
        document.getElementById('medName').value = '';
        document.getElementById('medDosage').value = '';
        document.getElementById('medDuration').value = '';
      } else {
        alert('Preencha pelo menos o nome e a posologia do medicamento.');
      }
    }
    
    function renderMedications() {
      const container = document.getElementById('medicationListContainer');
      container.innerHTML = '';
      
      medications.forEach((med, index) => {
        const medItem = document.createElement('div');
        medItem.className = 'medication-item';
        medItem.innerHTML = `
          <div><strong>${med.name}</strong></div>
          <div>${med.dosage}</div>
          <div>${med.duration}</div>
          <div class="medication-actions">
            <button onclick="removeMedication(${index})"><i class="fas fa-trash"></i></button>
          </div>
        `;
        container.appendChild(medItem);
      });
    }
    
    function removeMedication(index) {
      medications.splice(index, 1);
      renderMedications();
    }
    
    function savePrescription() {
      if (medications.length === 0) {
        alert('Adicione pelo menos um medicamento antes de salvar.');
        return;
      }
      
      const prescription = {
        patient: "Maria Silva",
        medications: medications,
        date: new Date().toISOString()
      };
      
      localStorage.setItem('lastPrescription', JSON.stringify(prescription));
      alert('Receita salva com sucesso!');
    }
    
    function printPrescription() {
      if (medications.length === 0) {
        alert('Adicione pelo menos um medicamento antes de imprimir.');
        return;
      }
      
      const printContent = `
        <div style="padding: 20px; font-family: Arial;">
          <h2>Receita Médica - Geriatria 360</h2>
          <p><strong>Paciente:</strong> Maria Silva</p>
          <p><strong>Data:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
          <hr>
          <h3>Medicações Prescritas:</h3>
          <ul>
            ${medications.map(med => 
              `<li><strong>${med.name}</strong> - ${med.dosage} - ${med.duration}</li>`
            ).join('')}
          </ul>
          <br><br>
          <p>________________________________</p>
          <p><strong>Dr. Silva</strong><br>CRM: 123456</p>
        </div>
      `;
      
      const printWindow = window.open('', '_blank');
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.print();
    }

    // Sistema de atestados
    function saveCertificate() {
      const type = document.getElementById('certType').value;
      const days = document.getElementById('certDays').value;
      const reason = document.getElementById('certReason').value;
      const restrictions = document.getElementById('certRestrictions').value;

      if (!reason) {
        alert('Por favor, preencha o motivo do atestado.');
        return;
      }

      const certificate = {
        type,
        days,
        reason,
        restrictions,
        date: new Date().toISOString(),
        patient: "Maria Silva"
      };

      localStorage.setItem('lastCertificate', JSON.stringify(certificate));
      alert('Atestado salvo com sucesso!');
    }

    function printCertificate() {
      const type = document.getElementById('certType').value;
      const days = document.getElementById('certDays').value;
      const reason = document.getElementById('certReason').value;
      const restrictions = document.getElementById('certRestrictions').value;

      if (!reason) {
        alert('Por favor, preencha o motivo do atestado.');
        return;
      }

      const typeText = type === 'sick_leave' ? 'Afastamento' : 'Atestado Médico';
      const daysText = days ? ` por ${days} dias` : '';

      const printContent = `
        <div style="padding: 20px; font-family: Arial;">
          <h2>${typeText} - Geriatria 360</h2>
          <p><strong>Paciente:</strong> Maria Silva</p>
          <p><strong>Data:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
          <hr>
          <p>Atesto que o(a) paciente <strong>Maria Silva</strong>${daysText} necessita de ${typeText.toLowerCase()} devido a:</p>
          <p>${reason}</p>
          ${restrictions ? `<p><strong>Recomendações/Restrições:</strong> ${restrictions}</p>` : ''}
          <br><br>
          <p>________________________________</p>
          <p><strong>Dr. Silva</strong><br>CRM: 123456</p>
        </div>
      `;
      
      const printWindow = window.open('', '_blank');
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.print();
    }
    
    // Sistema de exames
    function addCustomExam() {
      const examInput = document.getElementById('examInput');
      const examValue = examInput.value.trim();
      
      if (examValue) {
        if (!exams.includes(examValue)) {
          exams.push(examValue);
          renderExams();
        }
        examInput.value = '';
      } else {
        alert('Digite um exame para adicionar.');
      }
    }
    
    function renderExams() {
      const examList = document.getElementById('examList');
      examList.innerHTML = '';
      
      exams.forEach((exam, index) => {
        const li = document.createElement('li');
        li.style.cssText = 'display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--gray-light);';
        li.innerHTML = `
          <span>${exam}</span>
          <button style="background: none; border: none; color: var(--danger); cursor: pointer;" onclick="removeExam(${index})">
            <i class="fas fa-times"></i>
          </button>
        `;
        examList.appendChild(li);
      });
    }
    
    function removeExam(index) {
      exams.splice(index, 1);
      renderExams();
    }
    
    function saveExams() {
      if (exams.length === 0) {
        alert('Adicione pelo menos um exame antes de salvar.');
        return;
      }
      
      const examData = {
        patient: "Maria Silva",
        exams: exams,
        date: new Date().toISOString()
      };
      
      localStorage.setItem('lastExams', JSON.stringify(examData));
      alert('Solicitação de exames salva com sucesso!');
    }
    
    function printExams() {
      if (exams.length === 0) {
        alert('Adicione pelo menos um exame antes de imprimir.');
        return;
      }
      
      const printContent = `
        <div style="padding: 20px; font-family: Arial;">
          <h2>Solicitação de Exames - Geriatria 360</h2>
          <p><strong>Paciente:</strong> Maria Silva</p>
          <p><strong>Data:</strong> ${new Date().toLocaleDateString('pt-BR')}</p>
          <hr>
          <h3>Exames Solicitados:</h3>
          <ul>
            ${exams.map(exam => `<li>${exam}</li>`).join('')}
          </ul>
          <br><br>
          <p>________________________________</p>
          <p><strong>Dr. Silva</strong><br>CRM: 123456</p>
        </div>
      `;
      
      const printWindow = window.open('', '_blank');
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.print();
    }
    
    // Calendário
    let currentDate = new Date();
    
    function initCalendar() {
      updateCalendar();
    }
    
    function updateCalendar() {
      const monthNames = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
                         "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
      
      document.getElementById('currentMonth').textContent = 
        `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
      
      const calendarDates = document.getElementById('calendarDates');
      calendarDates.innerHTML = '';
      
      const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
      const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
      
      // Dias vazios no início
      for (let i = 0; i < firstDay.getDay(); i++) {
        const emptyDiv = document.createElement('div');
        emptyDiv.className = 'calendar-date';
        calendarDates.appendChild(emptyDiv);
      }
      
      // Dias do mês
      for (let i = 1; i <= lastDay.getDate(); i++) {
        const dateDiv = document.createElement('div');
        dateDiv.className = 'calendar-date';
        dateDiv.textContent = i;
        
        // Marcar data atual
        const today = new Date();
        if (i === today.getDate() && 
            currentDate.getMonth() === today.getMonth() && 
            currentDate.getFullYear() === today.getFullYear()) {
          dateDiv.classList.add('today');
        }
        
        dateDiv.addEventListener('click', () => selectDate(i));
        calendarDates.appendChild(dateDiv);
      }
    }
    
    function changeMonth(direction) {
      currentDate.setMonth(currentDate.getMonth() + direction);
      updateCalendar();
    }
    
    function selectDate(day) {
      alert(`Data selecionada: ${day}/${currentDate.getMonth() + 1}/${currentDate.getFullYear()}`);
    }
    
    // Outras funções
    function saveEvolution() {
      alert('Evolução salva com sucesso!');
    }
    
    function generateAIReport() {
      alert('Laudo gerado pela IA com base nas informações fornecidas!');
    }
    
    function newAppointment() {
      alert('Abrindo formulário para novo agendamento...');
    }
    
    function formatText(command) {
      document.execCommand(command, false, null);
    }

    function newDocument() {
      alert('Criando novo documento médico...');
    }

    function openDocument(type) {
      alert(`Abrindo documento: ${type}`);
    }
    
    // Inicialização
    document.addEventListener('DOMContentLoaded', function() {
      const medSuggestions = document.getElementById('medSuggestions');
      const commonMeds = [
        "Losartana 50mg", "AAS 100mg", "Sinvastatina 20mg", "Metformina 850mg",
        "Omeprazol 20mg", "Clopidogrel 75mg", "Atenolol 50mg", "Hidroclorotiazida 25mg"
      ];
      
      commonMeds.forEach(med => {
        const option = document.createElement('option');
        option.value = med;
        medSuggestions.appendChild(option);
      });
    });
  </script>
</body>
</html>
