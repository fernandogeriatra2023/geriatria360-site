<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Cl√°ssico - Geriatria 360</title>
    <style>
        /* Reset e estilos gerais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        .btn {
            display: inline-block;
            padding: 8px 16px;
            background: #007cba;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
        }
        .btn:hover {
            background: #005a87;
        }
        .btn-danger {
            background: #dc3545;
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-success:hover {
            background: #218838;
        }
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-bottom: none;
        }
        .toolbar button {
            padding: 5px 10px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
        }
        .toolbar button:hover {
            background: #e9ecef;
        }
        .editor {
            min-height: 400px;
            padding: 20px;
            border: 1px solid #ddd;
            background: #fff;
            overflow-y: auto;
            outline: none;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: #f8f9fa;
            border: 1px solid transparent;
            border-bottom: none;
            margin-bottom: -1px;
        }
        .tab.active {
            background: #fff;
            border-color: #ddd;
            border-radius: 4px 4px 0 0;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .image-upload-area {
            border: 2px dashed #ddd;
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            margin: 10px 0;
            cursor: pointer;
        }
        .image-upload-area:hover {
            border-color: #007cba;
        }
        .image-preview {
            max-width: 200px;
            max-height: 150px;
            margin-top: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="card" style="text-align: center;">
            <h1>Editor Cl√°ssico - Geriatria 360</h1>
            <p>Crie e edite conte√∫do para o site de forma f√°cil</p>
        </header>

        <div class="card">
            <div class="tabs">
                <div class="tab active" data-tab="banner">Banner</div>
                <div class="tab" data-tab="news">Not√≠cias</div>
                <div class="tab" data-tab="topics">T√≥picos</div>
                <div class="tab" data-tab="publish">Publicar</div>
            </div>

            <!-- Aba do Banner -->
            <div id="banner" class="tab-content active">
                <div class="form-group">
                    <label for="bannerTitle">T√≠tulo</label>
                    <input type="text" id="bannerTitle" class="form-control" placeholder="T√≠tulo do banner">
                </div>
                <div class="form-group">
                    <label for="bannerDate">Data</label>
                    <input type="date" id="bannerDate" class="form-control">
                </div>
                <div class="form-group">
                    <label for="bannerTag">Tag</label>
                    <input type="text" id="bannerTag" class="form-control" placeholder="Tag do banner">
                </div>
                <div class="form-group">
                    <label>Imagem do Banner</label>
                    <div class="image-upload-area" id="bannerImageUpload">
                        Clique aqui para adicionar uma imagem
                        <input type="file" id="bannerImageFile" class="hidden" accept="image/*">
                    </div>
                    <img id="bannerImagePreview" class="image-preview">
                    <input type="text" id="bannerImageUrl" class="form-control" placeholder="Ou cole a URL da imagem" style="margin-top: 10px;">
                </div>
                <div class="form-group">
                    <label>Conte√∫do</label>
                    <div class="toolbar">
                        <button type="button" data-command="bold" title="Negrito"><b>B</b></button>
                        <button type="button" data-command="italic" title="It√°lico"><i>I</i></button>
                        <button type="button" data-command="insertUnorderedList" title="Lista n√£o ordenada">‚ò∞</button>
                        <button type="button" data-command="insertOrderedList" title="Lista ordenada">1.</button>
                        <button type="button" data-command="createLink" title="Link">üîó</button>
                        <button type="button" data-command="unlink" title="Remover Link">‚ùå</button>
                        <button type="button" data-command="insertImage" title="Inserir Imagem">üñºÔ∏è</button>
                    </div>
                    <div id="bannerEditor" class="editor" contenteditable="true"></div>
                </div>
                <button id="saveBanner" class="btn btn-success">Salvar Banner</button>
            </div>

            <!-- Aba de Not√≠cias -->
            <div id="news" class="tab-content">
                <div class="form-group">
                    <label for="newsTitle">T√≠tulo</label>
                    <input type="text" id="newsTitle" class="form-control" placeholder="T√≠tulo da not√≠cia">
                </div>
                <div class="form-group">
                    <label for="newsType">Tipo</label>
                    <select id="newsType" class="form-control">
                        <option>Not√≠cia</option>
                        <option>Artigo</option>
                        <option>Comunicado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newsDate">Data</label>
                    <input type="date" id="newsDate" class="form-control">
                </div>
                <div class="form-group">
                    <label for="newsHref">Link (href)</label>
                    <input type="text" id="newsHref" class="form-control" placeholder="post.html?id=1">
                </div>
                <div class="form-group">
                    <label>Imagem da Not√≠cia</label>
                    <div class="image-upload-area" id="newsImageUpload">
                        Clique aqui para adicionar uma imagem
                        <input type="file" id="newsImageFile" class="hidden" accept="image/*">
                    </div>
                    <img id="newsImagePreview" class="image-preview">
                    <input type="text" id="newsImageUrl" class="form-control" placeholder="Ou cole a URL da imagem" style="margin-top: 10px;">
                </div>
                <div class="form-group">
                    <label>Conte√∫do</label>
                    <div class="toolbar">
                        <button type="button" data-command="bold" title="Negrito"><b>B</b></button>
                        <button type="button" data-command="italic" title="It√°lico"><i>I</i></button>
                        <button type="button" data-command="insertUnorderedList" title="Lista n√£o ordenada">‚ò∞</button>
                        <button type="button" data-command="insertOrderedList" title="Lista ordenada">1.</button>
                        <button type="button" data-command="createLink" title="Link">üîó</button>
                        <button type="button" data-command="unlink" title="Remover Link">‚ùå</button>
                        <button type="button" data-command="insertImage" title="Inserir Imagem">üñºÔ∏è</button>
                    </div>
                    <div id="newsEditor" class="editor" contenteditable="true"></div>
                </div>
                <button id="saveNews" class="btn btn-success">Salvar Not√≠cia</button>
            </div>

            <!-- Aba de T√≥picos -->
            <div id="topics" class="tab-content">
                <div class="form-group">
                    <label for="topicTitle">T√≠tulo</label>
                    <input type="text" id="topicTitle" class="form-control" placeholder="T√≠tulo do t√≥pico">
                </div>
                <div class="form-group">
                    <label for="topicSubtitle">Subt√≠tulo</label>
                    <input type="text" id="topicSubtitle" class="form-control" placeholder="Subt√≠tulo do t√≥pico">
                </div>
                <div class="form-group">
                    <label for="topicHref">Link (href)</label>
                    <input type="text" id="topicHref" class="form-control" placeholder="post.html?id=alzheimer">
                </div>
                <div class="form-group">
                    <label>Imagem do T√≥pico</label>
                    <div class="image-upload-area" id="topicImageUpload">
                        Clique aqui para adicionar uma imagem
                        <input type="file" id="topicImageFile" class="hidden" accept="image/*">
                    </div>
                    <img id="topicImagePreview" class="image-preview">
                    <input type="text" id="topicImageUrl" class="form-control" placeholder="Ou cole a URL da imagem" style="margin-top: 10px;">
                </div>
                <div class="form-group">
                    <label>Conte√∫do</label>
                    <div class="toolbar">
                        <button type="button" data-command="bold" title="Negrito"><b>B</b></button>
                        <button type="button" data-command="italic" title="It√°lico"><i>I</i></button>
                        <button type="button" data-command="insertUnorderedList" title="Lista n√£o ordenada">‚ò∞</button>
                        <button type="button" data-command="insertOrderedList" title="Lista ordenada">1.</button>
                        <button type="button" data-command="createLink" title="Link">üîó</button>
                        <button type="button" data-command="unlink" title="Remover Link">‚ùå</button>
                        <button type="button" data-command="insertImage" title="Inserir Imagem">üñºÔ∏è</button>
                    </div>
                    <div id="topicEditor" class="editor" contenteditable="true"></div>
                </div>
                <button id="saveTopic" class="btn btn-success">Salvar T√≥pico</button>
            </div>

            <!-- Aba de Publicar -->
            <div id="publish" class="tab-content">
                <h3>Publicar Altera√ß√µes</h3>
                <p>Ap√≥s salvar todas as altera√ß√µes, baixe o arquivo JSON atualizado e substitua no seu reposit√≥rio.</p>
                <button id="downloadJson" class="btn btn-success">Baixar data.json</button>
                <button id="copyJson" class="btn">Copiar JSON</button>
                <div class="form-group" style="margin-top: 20px;">
                    <label for="jsonOutput">Visualiza√ß√£o do JSON</label>
                    <textarea id="jsonOutput" class="form-control" rows="20" readonly></textarea>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Estado global
        const state = {
            data: {
                banner: [],
                news: [],
                topics: [],
                auth: { cms_password: "senha123" } // Altere para a senha desejada
            },
            currentBanner: null,
            currentNews: null,
            currentTopic: null
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            // Carrega o data.json existente, se houver
            loadExistingData();

            // Inicializa abas
            initTabs();

            // Inicializa os editores
            initEditors();

            // Inicializa upload de imagens
            initImageUploads();

            // Eventos de salvar
            document.getElementById('saveBanner').addEventListener('click', saveBanner);
            document.getElementById('saveNews').addEventListener('click', saveNews);
            document.getElementById('saveTopic').addEventListener('click', saveTopic);

            // Eventos de publicar
            document.getElementById('downloadJson').addEventListener('click', downloadJson);
            document.getElementById('copyJson').addEventListener('click', copyJson);
        });

        function loadExistingData() {
            // Tenta carregar o data.json existente
            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    state.data = data;
                    updateJSONPreview();
                })
                .catch(error => {
                    console.log('N√£o foi poss√≠vel carregar data.json. Iniciando com dados vazios.');
                });
        }

        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove a classe active de todas as abas e conte√∫dos
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

                    // Adiciona a classe active na aba clicada e no conte√∫do correspondente
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');

                    // Atualiza o preview do JSON na aba de publicar
                    if (tabId === 'publish') {
                        updateJSONPreview();
                    }
                });
            });
        }

        function initEditors() {
            // Inicializa a toolbar para todos os editores
            const toolbars = document.querySelectorAll('.toolbar');
            toolbars.forEach(toolbar => {
                toolbar.addEventListener('click', function(e) {
                    if (e.target.tagName === 'BUTTON') {
                        const command = e.target.getAttribute('data-command');
                        if (command === 'createLink') {
                            const url = prompt('Digite a URL:');
                            if (url) {
                                document.execCommand(command, false, url);
                            }
                        } else if (command === 'insertImage') {
                            const url = prompt('Digite a URL da imagem:');
                            if (url) {
                                document.execCommand(command, false, url);
                            }
                        } else {
                            document.execCommand(command, false, null);
                        }
                    }
                });
            });
        }

        function initImageUploads() {
            // Banner
            document.getElementById('bannerImageUpload').addEventListener('click', () => {
                document.getElementById('bannerImageFile').click();
            });
            document.getElementById('bannerImageFile').addEventListener('change', function(e) {
                handleImageUpload(e, 'banner');
            });

            // News
            document.getElementById('newsImageUpload').addEventListener('click', () => {
                document.getElementById('newsImageFile').click();
            });
            document.getElementById('newsImageFile').addEventListener('change', function(e) {
                handleImageUpload(e, 'news');
            });

            // Topic
            document.getElementById('topicImageUpload').addEventListener('click', () => {
                document.getElementById('topicImageFile').click();
            });
            document.getElementById('topicImageFile').addEventListener('change', function(e) {
                handleImageUpload(e, 'topic');
            });
        }

        function handleImageUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const imageDataUrl = e.target.result;
                // Atualiza o preview
                document.getElementById(`${type}ImagePreview`).src = imageDataUrl;
                // Atualiza o campo de URL
                document.getElementById(`${type}ImageUrl`).value = imageDataUrl;
            };
            reader.readAsDataURL(file);
        }

        function saveBanner() {
            const banner = {
                title: document.getElementById('bannerTitle').value,
                date: document.getElementById('bannerDate').value,
                tag: document.getElementById('bannerTag').value,
                image: document.getElementById('bannerImageUrl').value,
                content: document.getElementById('bannerEditor').innerHTML
            };

            if (!banner.title) {
                alert('Por favor, preencha o t√≠tulo.');
                return;
            }

            state.data.banner.push(banner);
            updateJSONPreview();
            clearBannerForm();
            alert('Banner salvo com sucesso!');
        }

        function saveNews() {
            const news = {
                title: document.getElementById('newsTitle').value,
                type: document.getElementById('newsType').value,
                date: document.getElementById('newsDate').value,
                href: document.getElementById('newsHref').value,
                image: document.getElementById('newsImageUrl').value,
                content: document.getElementById('newsEditor').innerHTML
            };

            if (!news.title) {
                alert('Por favor, preencha o t√≠tulo.');
                return;
            }

            state.data.news.push(news);
            updateJSONPreview();
            clearNewsForm();
            alert('Not√≠cia salva com sucesso!');
        }

        function saveTopic() {
            const topic = {
                title: document.getElementById('topicTitle').value,
                subtitle: document.getElementById('topicSubtitle').value,
                href: document.getElementById('topicHref').value,
                image: document.getElementById('topicImageUrl').value,
                content: document.getElementById('topicEditor').innerHTML
            };

            if (!topic.title) {
                alert('Por favor, preencha o t√≠tulo.');
                return;
            }

            state.data.topics.push(topic);
            updateJSONPreview();
            clearTopicForm();
            alert('T√≥pico salvo com sucesso!');
        }

        function clearBannerForm() {
            document.getElementById('bannerTitle').value = '';
            document.getElementById('bannerDate').value = '';
            document.getElementById('bannerTag').value = '';
            document.getElementById('bannerImageUrl').value = '';
            document.getElementById('bannerEditor').innerHTML = '';
            document.getElementById('bannerImagePreview').src = '';
            document.getElementById('bannerImageFile').value = '';
        }

        function clearNewsForm() {
            document.getElementById('newsTitle').value = '';
            document.getElementById('newsType').value = 'Not√≠cia';
            document.getElementById('newsDate').value = '';
            document.getElementById('newsHref').value = '';
            document.getElementById('newsImageUrl').value = '';
            document.getElementById('newsEditor').innerHTML = '';
            document.getElementById('newsImagePreview').src = '';
            document.getElementById('newsImageFile').value = '';
        }

        function clearTopicForm() {
            document.getElementById('topicTitle').value = '';
            document.getElementById('topicSubtitle').value = '';
            document.getElementById('topicHref').value = '';
            document.getElementById('topicImageUrl').value = '';
            document.getElementById('topicEditor').innerHTML = '';
            document.getElementById('topicImagePreview').src = '';
            document.getElementById('topicImageFile').value = '';
        }

        function updateJSONPreview() {
            document.getElementById('jsonOutput').value = JSON.stringify(state.data, null, 2);
        }

        function downloadJson() {
            const dataStr = JSON.stringify(state.data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'data.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function copyJson() {
            const jsonOutput = document.getElementById('jsonOutput');
            jsonOutput.select();
            document.execCommand('copy');
            alert('JSON copiado para a √°rea de transfer√™ncia!');
        }
    </script>
</body>
</html>
