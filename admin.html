<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Editor · Geriatria 360</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css"/>
  <style>
    /* ====== Admin styles atualizados ====== */
    .admin-top{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:10}
    .admin-top .row{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:12px 0}
    .brand{font-weight:800}
    .pill-badge{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:3px 8px;font-size:12px;color:var(--muted)}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:16px 0 12px}
    .tab{padding:8px 12px;border:1px solid var(--border);border-radius:999px;background:#fff;cursor:pointer}
    .tab.active{background:linear-gradient(90deg,var(--brand),var(--brand2));color:#fff;border-color:transparent}
    .adm-grid{display:grid;gap:20px;grid-template-columns:1fr}
    @media(min-width:1000px){.adm-grid{grid-template-columns:1.1fr 1fr}}
    .list{border:1px solid var(--border);border-radius:16px;background:#fff;overflow:hidden}
    .list .head{display:flex;justify-content:space-between;align-items:center;padding:14px;border-bottom:1px solid var(--border)}
    .list .row{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px 14px;border-top:1px solid var(--border)}
    .list .row:first-of-type{border-top:none}
    .muted{color:var(--muted)}
    .danger{color:#b91c1c}
    .good{color:#047857}
    .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);padding:10px 14px;border-radius:12px;background:#fff;text-decoration:none;color:var(--ink);cursor:pointer}
    .btn:hover{background:#f8fafc}
    .primary{background:linear-gradient(90deg,var(--brand),var(--brand2));color:#fff;border:none}
    .form{border:1px dashed var(--border);border-radius:16px;background:#fff;padding:16px}
    .form .grid{display:grid;gap:12px}
    .grid2{grid-template-columns:1fr}
    @media(min-width:700px){.grid2{grid-template-columns:1fr 1fr}}
    .footer-bar{display:flex;gap:10px;flex-wrap:wrap;padding:12px;border-top:1px solid var(--border);background:#fff;border-radius:0 0 16px 16px}
    .empty{padding:20px;text-align:center;color:var(--muted)}
    .login-card{max-width:420px;margin:12vh auto;border:1px solid var(--border);border-radius:16px;background:#fff;padding:22px}
    
    /* Novos estilos para editor rico e imagens */
    .editor-rico {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      min-height: 200px;
      background: #fff;
    }
    .editor-toolbar {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    .editor-toolbar button {
      padding: 8px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: white;
      cursor: pointer;
    }
    .editor-toolbar button:hover {
      background: #f8fafc;
    }
    .image-preview {
      max-width: 200px;
      max-height: 150px;
      border-radius: 8px;
      margin-top: 10px;
      border: 1px solid var(--border);
    }
    .image-upload-area {
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      margin: 10px 0;
    }
    .image-upload-area:hover {
      background: #f8fafc;
    }
    .image-upload-area i {
      font-size: 24px;
      margin-bottom: 8px;
      color: var(--muted);
    }
  </style>
</head>
<body>

<header class="admin-top">
  <div class="container row">
    <div class="brand">Geriatria 360 · <span class="muted">Editor Profissional</span></div>
    <nav class="seg">
      <a class="btn" href="index.html">Voltar ao site</a>
      <a id="repoLink" class="btn" target="_blank">Abrir repositório</a>
    </nav>
  </div>
</header>

<main class="container" style="padding:18px 0 28px">
  <!-- LOGIN -->
  <section id="login">
    <div class="login-card">
      <h2 style="margin:0 0 8px">Entrar</h2>
      <p class="muted" style="margin:0 0 12px">Use a senha do editor (definida em <code>data.json → auth.cms_password</code>).</p>
      <div class="grid grid2">
        <div>
          <label class="muted">Senha</label>
          <input id="cms-pass" type="password" placeholder="••••••••"/>
        </div>
        <div style="align-self:end">
          <button class="btn primary" id="btnLogin">Entrar</button>
        </div>
      </div>
      <div id="loginMsg" class="muted" style="margin-top:10px"></div>
    </div>
  </section>

  <!-- APP -->
  <section id="app" style="display:none">
    <div class="tabs">
      <div class="tab active" data-panel="panel-banner">Banner</div>
      <div class="tab" data-panel="panel-news">Notícias</div>
      <div class="tab" data-panel="panel-topics">Tópicos</div>
      <div class="tab" data-panel="panel-publicar">Publicar</div>
    </div>

    <!-- BANNER -->
    <div id="panel-banner">
      <div class="adm-grid">
        <div class="list">
          <div class="head">
            <div><b>Itens do banner</b> <span class="pill-badge" id="countBanner">0</span></div>
            <button class="btn" id="addBanner">Novo</button>
          </div>
          <div id="bannerList"></div>
          <div class="empty" id="bannerEmpty" style="display:none">Nenhum item.</div>
        </div>

        <div class="form">
          <h3 style="margin:0 0 8px">Editor do Banner</h3>
          
          <div class="grid grid2">
            <div>
              <label class="muted">Título</label>
              <input id="b_title" placeholder="Ex.: Campanha de Vacinação"/>
            </div>
            <div>
              <label class="muted">Data</label>
              <input id="b_date" type="date"/>
            </div>
            <div>
              <label class="muted">Tag</label>
              <input id="b_tag" placeholder="Importante / Prevenção"/>
            </div>
          </div>

          <!-- Área de upload de imagem para banner -->
          <div style="margin: 15px 0;">
            <label class="muted">Imagem do Banner</label>
            <div class="image-upload-area" id="bannerImageUpload">
              <i class="fas fa-cloud-upload-alt"></i>
              <div>Clique para adicionar imagem</div>
              <input type="file" id="b_imageFile" accept="image/*" style="display: none"/>
            </div>
            <img id="bannerImagePreview" class="image-preview" style="display:none"/>
            <input type="text" id="b_image" placeholder="Ou cole URL da imagem" style="margin-top: 10px; width: 100%"/>
          </div>

          <!-- Editor de texto rico para banner -->
          <div style="margin: 15px 0;">
            <label class="muted">Descrição/Conteúdo</label>
            <div class="editor-toolbar">
              <button type="button" data-cmd="bold"><i class="fas fa-bold"></i></button>
              <button type="button" data-cmd="italic"><i class="fas fa-italic"></i></button>
              <button type="button" data-cmd="insertUnorderedList"><i class="fas fa-list-ul"></i></button>
              <button type="button" data-cmd="insertOrderedList"><i class="fas fa-list-ol"></i></button>
              <button type="button" data-cmd="createLink"><i class="fas fa-link"></i></button>
            </div>
            <div class="editor-rico" id="b_content" contenteditable="true"></div>
          </div>

          <div class="footer-bar">
            <button class="btn primary" id="saveBanner">Salvar</button>
            <button class="btn" id="resetBanner">Limpar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- NEWS -->
    <div id="panel-news" style="display:none">
      <div class="adm-grid">
        <div class="list">
          <div class="head">
            <div><b>Notícias</b> <span class="pill-badge" id="countNews">0</span></div>
            <button class="btn" id="addNews">Nova</button>
          </div>
          <div id="newsList"></div>
          <div class="empty" id="newsEmpty" style="display:none">Nenhuma notícia.</div>
        </div>

        <div class="form">
          <h3 style="margin:0 0 8px">Editor de Notícias</h3>
          <div class="grid grid2">
            <div>
              <label class="muted">Título</label>
              <input id="n_title" placeholder="Ex.: Sarcopenia: sinais de alerta"/>
            </div>
            <div>
              <label class="muted">Tipo</label>
              <select id="n_type">
                <option>Notícia</option>
                <option>Artigo</option>
                <option>Comunicado</option>
              </select>
            </div>
            <div>
              <label class="muted">Data</label>
              <input id="n_date" type="date"/>
            </div>
            <div>
              <label class="muted">Link (href)</label>
              <input id="n_href" placeholder="post.html?id=1"/>
            </div>
          </div>

          <!-- Imagem para notícias -->
          <div style="margin: 15px 0;">
            <label class="muted">Imagem da Notícia</label>
            <div class="image-upload-area" id="newsImageUpload">
              <i class="fas fa-cloud-upload-alt"></i>
              <div>Clique para adicionar imagem</div>
              <input type="file" id="n_imageFile" accept="image/*" style="display: none"/>
            </div>
            <img id="newsImagePreview" class="image-preview" style="display:none"/>
            <input type="text" id="n_image" placeholder="Ou cole URL da imagem" style="margin-top: 10px; width: 100%"/>
          </div>

          <!-- Editor de texto rico para notícias -->
          <div style="margin: 15px 0;">
            <label class="muted">Conteúdo da Notícia</label>
            <div class="editor-toolbar">
              <button type="button" data-cmd="bold"><i class="fas fa-bold"></i></button>
              <button type="button" data-cmd="italic"><i class="fas fa-italic"></i></button>
              <button type="button" data-cmd="insertUnorderedList"><i class="fas fa-list-ul"></i></button>
              <button type="button" data-cmd="insertOrderedList"><i class="fas fa-list-ol"></i></button>
              <button type="button" data-cmd="createLink"><i class="fas fa-link"></i></button>
            </div>
            <div class="editor-rico" id="n_content" contenteditable="true"></div>
          </div>

          <div class="footer-bar">
            <button class="btn primary" id="saveNews">Salvar</button>
            <button class="btn" id="resetNews">Limpar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- TOPICS -->
    <div id="panel-topics" style="display:none">
      <div class="adm-grid">
        <div class="list">
          <div class="head">
            <div><b>Tópicos</b> <span class="pill-badge" id="countTopics">0</span></div>
            <button class="btn" id="addTopic">Novo</button>
          </div>
          <div id="topicsList"></div>
          <div class="empty" id="topicsEmpty" style="display:none">Nenhum tópico.</div>
        </div>

        <div class="form">
          <h3 style="margin:0 0 8px">Editor de Tópicos</h3>
          <div class="grid grid2">
            <div>
              <label class="muted">Título</label>
              <input id="t_title" placeholder="Ex.: Doença de Alzheimer"/>
            </div>
            <div>
              <label class="muted">Subtítulo</label>
              <input id="t_subtitle" placeholder="Sinais e condutas iniciais."/>
            </div>
            <div>
              <label class="muted">Link (href)</label>
              <input id="t_href" placeholder="post.html?id=alzheimer"/>
            </div>
          </div>

          <!-- Imagem para tópicos -->
          <div style="margin: 15px 0;">
            <label class="muted">Imagem do Tópico</label>
            <div class="image-upload-area" id="topicImageUpload">
              <i class="fas fa-cloud-upload-alt"></i>
              <div>Clique para adicionar imagem</div>
              <input type="file" id="t_imageFile" accept="image/*" style="display: none"/>
            </div>
            <img id="topicImagePreview" class="image-preview" style="display:none"/>
            <input type="text" id="t_image" placeholder="Ou cole URL da imagem" style="margin-top: 10px; width: 100%"/>
          </div>

          <!-- Editor de texto rico para tópicos -->
          <div style="margin: 15px 0;">
            <label class="muted">Conteúdo Detalhado</label>
            <div class="editor-toolbar">
              <button type="button" data-cmd="bold"><i class="fas fa-bold"></i></button>
              <button type="button" data-cmd="italic"><i class="fas fa-italic"></i></button>
              <button type="button" data-cmd="insertUnorderedList"><i class="fas fa-list-ul"></i></button>
              <button type="button" data-cmd="insertOrderedList"><i class="fas fa-list-ol"></i></button>
              <button type="button" data-cmd="createLink"><i class="fas fa-link"></i></button>
            </div>
            <div class="editor-rico" id="t_content" contenteditable="true"></div>
          </div>

          <div class="footer-bar">
            <button class="btn primary" id="saveTopic">Salvar</button>
            <button class="btn" id="resetTopic">Limpar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- PUBLICAR -->
    <div id="panel-publicar" style="display:none">
      <div class="card">
        <h3 style="margin-top:0">Publicar alterações</h3>
        <p class="muted">Como é um site estático, exporte o <code>data.json</code> e substitua no repositório.</p>
        <div class="seg" style="gap:10px;margin:10px 0 0">
          <button class="btn primary" id="downloadJson">Baixar data.json</button>
          <button class="btn" id="copyJson">Copiar JSON</button>
          <button class="btn" id="openRepo">Abrir repositório</button>
        </div>
        <textarea id="jsonPreview" class="editor" style="margin-top:14px;min-height:200px" spellcheck="false"></textarea>
      </div>
    </div>

  </section>
</main>

<script src="admin.js" defer></script>
</body>
</html>
